<script id='app_button' type='text/template'>
  <div class='row-fluid'>
    <h5>
      <%= name %>
    </h5>
  </div>
</script>
<script id='app_timer' type='text/template'>
  <div class='row-fluid'>
    <div class='timer-container'>
      <div class='row-fluid'>
        <div class='span4'>
          <div class='button-container'>
            <!-- /<img src="./img/powersymbol.png" style="width:40%;top:12px;left:15px;position:relative"/> -->
            <div class="button" id="<%= appliance_id %>">
            </div>
            <div class="button-shadow" id="<%= appliance_id %>"></div>
          </div>
        </div>
        <div class='span8'>
          <div class='row-fluid'>
            <div class='span12'>
              <div class='title-container'>
                <h5>
                  <div class="name" id="<%= appliance_id %>"><%= name %></div>
                </h5>
              </div>
            </div>
          </div>
          <div class='row-fluid'>
            <div class='span12'>
              <div class="time-display" id="<%= appliance_id %>"></div>
            </div>
          </div>
          <div class='row-fluid'>
            <div class='span12'>
              <div class="cost-display" id="<%= appliance_id %>"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</script>
<script id='comparison_frame' type='text/template'>
  <div class='comparison-frame row-fluid'>
    <div class='span12'>
      <div class='row-fluid'>
        <div class='comparison-title span12'>
          <h3>
            To save &#163;<%= daily_saving %> a day / &#163;<%= yearly_saving %> a year...
          </h3>
        </div>
      </div>
      <div class='row-fluid'>
        <div class='comparison-table span4'>
          <div class='row-fluid'>
            <div class='span12'>
              You could reduce your daily use of the following appliances by ...
            </div>
          </div>
          <div class='row-fluid'>
            <div class='span12'>
              <table>
                <tr>
                  <td>
                    
                  </td>
                  <td>
                    Hours
                  </td>
                  <td>
                    Mins
                  </td>
                  <td>
                    Secs
                  </td>
                  <td>
                    Mils
                  </td>
                </tr>
                <% _.each(appliance_usages, function(appliance_usage) { %>
                	<% appliance = _.find(appliance_data, function(appliance) {
                		//alert(appliance.appliance_id+","+appliance_usage.appliance_id);
                		return appliance.appliance_id === appliance_usage.appliance_id
                	});
                	reduction_timestamp = formatTimestamp(appliance_usage.reduction_timestamp, false)
                %>
                <tr>
                  <td>
                    <%= appliance.name %>
                  </td>
                  <td>
                    <%= reduction_timestamp[0] %>
                  </td>
                  <td>
                    <%= reduction_timestamp[1] %>
                  </td>
                  <td>
                    <%= reduction_timestamp[2] %>
                  </td>
                  <td>
                    <%= reduction_timestamp[3] %>
                  </td>
                </tr>
                <% }); %>
              </table>
            </div>
          </div>
        </div>
        <div class='comparison-or span4'>
          <div class='row-fluid'>
            <div class='span12'>
              <div class='or-frame'>
                OR
              </div>
            </div>
          </div>
        </div>
        <div class='comparison-reward span4'>
          <div class='row-fluid'>
            <div class='span12'>
              Switch to this tariff :
              <% provider = _.find(window.tariffSelector.get('provider_data'), function(provider) {
              	return provider.provider_id == alternate_tariff.provider_id;
              }); %>
              <% region = _.find(window.tariffSelector.get('region_data'), function(region) {
              	return region.region_id == alternate_tariff.region_id;
              }); %>
              <% console.log(window.tariffSelector.get('provider_data')); %>
            </div>
          </div>
          <div class='row-fluid'>
            <div class='span12'>
              Provider : <%= provider.title %>
            </div>
          </div>
          <div class='row-fluid'>
            <div class='span12'>
              Region : <%= region.title %>
            </div>
          </div>
          <div class='row-fluid'>
            <div class='span12'>
              Tariff : <%= alternate_tariff.tariff_label %>
            </div>
          </div>
        </div>
      </div>
      <div class='row-fluid'>
        <div class='span12'>
          <h3>
            That's enough saving to purchase a <%= saving_reward.title %>
          </h3>
        </div>
      </div>
    </div>
  </div>
</script>
<script id='tariff_selector' type='text/template'>
  <%
  	region_data = _.sortBy(tariff_selector_data.region_data, function(region) {
  		return region.title;
  	});
  	
  	regional_tariffs = _.filter(tariff_selector_data.tariff_data,function(tariff) {
  		return tariff.region_id === user_data.region_id;
  	});
  	provider_ids = _.uniq(_.map(regional_tariffs, function(tariff) {
  		return tariff.provider_id;
  	}));
  	
  	provider_data = _.sortBy(_.filter(tariff_selector_data.provider_data, function(provider) {
  		if($.inArray(provider.provider_id, provider_ids) != -1)
  			return true
  		else
  			return false
  	}), function(provider) {
  		return provider.title;
  	});
  	tariff_data = _.filter(tariff_selector_data.tariff_data, function(tariff) {
  		return ((tariff.provider_id === user_data.provider_id) && (tariff.region_id === user_data.region_id))
  	});
  	
  %>
  <div class='row-fluid'>
    <div class='span4' id='select_region_frame'>
      <div class='styled-select'>
        <select id='region_select'>
          <% _.each(region_data, function(region) { 
          	if (region.region_id === user_data.region_id) { %>
          		<option value="<%= region.region_id %>" selected><%= region.title %></option>
          	<% } else { %>
          		<option value="<%= region.region_id %>"><%= region.title %></option>
          	<% } %>
          <% }); %>
        </select>
      </div>
    </div>
    <div class='span4' id='select_provider_frame'>
      <div class='styled-select'>
        <select id='provider_select'>
          <% _.each(provider_data, function(provider) { 
          	if (provider.provider_id === user_data.provider_id) { %>
          		<option value="<%= provider.provider_id %>" selected><%= provider.title %></option>
          	<% } else { %>
          		<option value="<%= provider.provider_id %>"><%= provider.title %></option>
          	<% } %>
          <% }); %>
        </select>
      </div>
    </div>
    <div class='span4' id='select_tariff_frame'>
      <div class='styled-select'>
        <select id='tariff_select'>
          <% _.each(tariff_data, function(tariff) { 
          	if (tariff.region_id === user_data.tariff_id) { %>
          		<option value="<%= tariff.tariff_id %>" selected><%= tariff.tariff_label %></option>
          	<% } else { %>
          		<option value="<%= tariff.tariff_id %>"><%= tariff.tariff_label %></option>
          	<% } %>
          <% }); %>
        </select>
      </div>
    </div>
  </div>
</script>
<script id='info_frame_template' type='text/template'>
  <div id='info_frame_container'>
    <div id='info_frame'>
      <div class='row-fluid'>
        <div class='span12'></div>
        Some information for you to start off.
        <a href='#' id='info_frame_close_link'>
          Close/ Go
        </a>
      </div>
    </div>
  </div>
</script>
<script id='summary_frame_template' type='text/template'>
  <% console.log() %>
</script>
