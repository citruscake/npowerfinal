<script id='app_button' type='text/template'>
  <div class='row-fluid'>
    <h5>
      <%= name %>
    </h5>
  </div>
</script>
<script id='app_timer' type='text/template'>
  <div class='row-fluid'>
    <div class='timer-container'>
      <div class='row-fluid'>
        <div class='span4'>
          <div class='button-container'>
            <!-- /<img src="./img/powersymbol.png" style="width:40%;top:12px;left:15px;position:relative"/> -->
            <div class="button" id="<%= appliance_id %>">
            </div>
            <div class="button-shadow"></div>
          </div>
        </div>
        <div class='span8'>
          <div class='row-fluid'>
            <div class='span12'>
              <div class='title-container'>
                <h5>
                  <div class="name" id="<%= appliance_id %>"><%= name %></div>
                </h5>
              </div>
            </div>
          </div>
          <div class='row-fluid'></div>
        </div>
      </div>
    </div>
  </div>
</script>
<script id='comparison_frame' type='text/template'>
  <div class='row-fluid'>
    To save &#163;<%= daily_saving %>a day / &#163;<%= yearly_saving %> a year...
  </div>
  <div class='row-fluid'>
    <div class='span4'>
      <% _.each(appliance_usages, function(appliance_usage) { %>
      	<b><%= appliance_usage.appliance_id %></b></br>
      	<b><%= appliance_usage.reduction_timestamp %></b>
      <% }); %>
    </div>
    <div class='span4'></div>
    <div class='span4'></div>
  </div>
</script>
<script id='tariff_selector' type='text/template'>
  <%
  	region_data = _.sortBy(tariff_selector_data.region_data, function(region) {
  		return region.title;
  	});
  	
  	regional_tariffs = _.filter(tariff_selector_data.tariff_data,function(tariff) {
  		return tariff.region_id === user_data.region_id;
  	});
  	provider_ids = _.uniq(regional_tariffs, function(tariff) {
  		return tariff.provider_id;
  	});
  	
  	provider_data = _.sortBy(_.filter(tariff_selector_data.provider_data, function(provider) {
  		return $.inArray(provider.provider_id, provider_ids);
  	}), function(provider) {
  		return provider.title;
  	});
  	tariff_data = _.filter(tariff_selector_data.tariff_data, function(tariff) {
  		return ((tariff.provider_id === user_data.provider_id) && (tariff.region_id === user_data.region_id))
  	});
  	
  %>
  <div class='row-fluid'>
    <div class='span4' id='select_region_frame'>
      <select id='region_select'>
        <% _.each(region_data, function(region) { 
        	if (region.region_id === user_data.region_id) { %>
        		<option value="<%= region.region_id %>" selected><%= region.title %></option>
        	<% } else { %>
        		<option value="<%= region.region_id %>"><%= region.title %></option>
        	<% } %>
        <% }); %>
      </select>
    </div>
    <div class='span4' id='select_provider_frame'>
      <select id='provider_select'>
        <% _.each(provider_data, function(provider) { 
        	if (provider.provider_id === user_data.provider_id) { %>
        		<option value="<%= provider.provider_id %>" selected><%= provider.title %></option>
        	<% } else { %>
        		<option value="<%= provider.provider_id %>"><%= provider.title %></option>
        	<% } %>
        <% }); %>
      </select>
    </div>
    <div class='span4' id='select_tariff_frame'>
      <select id='tariff_select'>
        <% _.each(tariff_data, function(tariff) { 
        	if (tariff.region_id === user_data.tariff_id) { %>
        		<option value="<%= tariff.tariff_id %>" selected><%= tariff.tariff_label %></option>
        	<% } else { %>
        		<option value="<%= tariff.tariff_id %>"><%= tariff.tariff_label %></option>
        	<% } %>
        <% }); %>
      </select>
    </div>
  </div>
</script>
